{
  "tipo": "package",
  "SnpPackage": [
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpPackage",
      "PackName": "PKG_CON_LOAD_CB_CUENTA_COB_CONTA_ODS"
    }
  ],
  "SnpConnect": [
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpConnect",
      "ConName": "PRD_ODS",
      "ConnectType": "D",
      "SnpMtxt": {
        "Object": "com.sunopsis.dwg.dbobj.SnpMtxt",
        "ITxt": "2000",
        "Txt": "jdbc:oracle:thin:@172.16.24.10:1521:ODS"
      },
      "SnpMorigTxt": {
        "Object": "com.sunopsis.dwg.dbobj.SnpMorigTxt",
        "OrigineName": "MOrigTxt.Connect.JavaURL",
        "ITxtOrig": "6"
      }
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpConnect",
      "ConName": "PRD_ODI",
      "ConnectType": "D",
      "SnpMtxt": {
        "Object": "com.sunopsis.dwg.dbobj.SnpMtxt",
        "ITxt": "489000",
        "Txt": "jdbc:oracle:thin:@172.16.24.10:1521:OBI"
      }
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpConnect",
      "ConName": "SOURCE_COB_CONTA",
      "ConnectType": "D",
      "SnpMtxt": {
        "Object": "com.sunopsis.dwg.dbobj.SnpMtxt",
        "ITxt": "459000",
        "Txt": "jdbc:weblogic:sybase://10.0.0.45:2025;DatabaseName=cob_conta"
      }
    }
  ],
  "SnpLschema": [
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpLschema",
      "LschemaName": "LS_ODS"
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpLschema",
      "LschemaName": "LS_ODI"
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpLschema",
      "LschemaName": "LS_SOURCE_COB_CONTA"
    }
  ],
  "SnpTable": [
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpTable",
      "TableName": "cb_cuenta",
      "ITable": "1458001"
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpTable",
      "TableName": "CB_CUENTA",
      "ITable": "1256001"
    }
  ],
  "SnpVar": [
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpVar",
      "DefV": "x",
      "LschemaName": "LS_ODS",
      "VarName": "vSrcNombreTablaOds",
      "ITxtVar": "16620001",
      "ITxtVarIn": "null",
      "SnpTxtHeader": [
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpTxtHeader",
          "ITxt": "16620001",
          "Txt": "Se define la tabla a Consultar"
        }
      ]
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpVar",
      "DefV": "null",
      "LschemaName": "LS_ODI",
      "VarName": "vOdsSessionProccessval",
      "ITxtVar": "null",
      "ITxtVarIn": "15926001",
      "SnpTxtHeader": [
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpTxtHeader",
          "ITxt": "15926001",
          "Txt": "select \n<%=odiRef.getPrevStepLog(\"SESS_NO\")%>\nfrom dual"
        }
      ]
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpVar",
      "DefV": "null",
      "LschemaName": "LS_ODI",
      "VarName": "vOdsSessionLoad",
      "ITxtVar": "15932001",
      "ITxtVarIn": "15999001",
      "SnpTxtHeader": [
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpTxtHeader",
          "ITxt": "15999001",
          "Txt": "select \n<%=odiRef.getPrevStepLog(\"SESS_NO\")%>\nfrom dual"
        }
      ]
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpVar",
      "DefV": "01/01/1801",
      "LschemaName": "LS_ODS",
      "VarName": "vSrcFechaCarga",
      "ITxtVar": "1892001",
      "ITxtVarIn": "1699001",
      "SnpTxtHeader": [
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpTxtHeader",
          "ITxt": "1699001",
          "Txt": "SELECT NVL(TO_CHAR(MIN(bcs.cds_date),'#SIG.vSrcFormatoFecha'), '01/01/1801')\nFROM BAN_CONFIG_ODS_DATE bcs,\n        BAN_CONFIG_ODS o\nWHERE bcs.cds_source =  '#SIG.vSrcNombreTablaOds'\nAND bcs.cds_status_carga =  'POR PROCESAR'\n AND O.COO_SOURCE = BCS.cds_source\n  and  bcs.cds_date BETWEEN o.coo_start_date and o.coo_end_date"
        }
      ]
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpVar",
      "DefV": "MM/DD/YYYY",
      "LschemaName": "LS_ODS",
      "VarName": "vSrcFormatoFecha",
      "ITxtVar": "17334001",
      "ITxtVarIn": "8669060",
      "SnpTxtHeader": [
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpTxtHeader",
          "ITxt": "8669060",
          "Txt": "SELECT 'MM/DD/YYYY' FROM DUAL"
        }
      ]
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpVar",
      "DefV": "NADA",
      "LschemaName": "LS_ODS",
      "VarName": "vSrcPartition",
      "ITxtVar": "17336001",
      "ITxtVarIn": "16779001",
      "SnpTxtHeader": [
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpTxtHeader",
          "ITxt": "16779001",
          "Txt": "SELECT MAX(GET_PARTITION(to_date('#vSrcFechaCarga','#vSrcFormatoFecha'),'#vSrcNombreTablaOds'))\nFROM DUAL"
        }
      ]
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpVar",
      "DefV": "null",
      "LschemaName": "LS_ODS",
      "VarName": "vSrcTipoCarga",
      "ITxtVar": "17339001",
      "ITxtVarIn": "2058001",
      "SnpTxtHeader": [
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpTxtHeader",
          "ITxt": "2058001",
          "Txt": "SELECT bcsd.COO_ATTRIBUTE1\nFROM BAN_CONFIG_ODS bcsd\nWHERE bcsd.COO_SOURCE = '#vSrcNombreTablaOds'"
        }
      ]
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpVar",
      "DefV": "null",
      "LschemaName": "null",
      "VarName": "vStgNumLote",
      "ITxtVar": "null",
      "ITxtVarIn": "null"
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpVar",
      "DefV": "null",
      "LschemaName": "null",
      "VarName": "vSrcCargaStatus",
      "ITxtVar": "16621001",
      "ITxtVarIn": "null",
      "SnpTxtHeader": [
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpTxtHeader",
          "ITxt": "16621001",
          "Txt": "Definir el Status del proceso"
        }
      ]
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpVar",
      "DefV": "null",
      "LschemaName": "LS_ODS",
      "VarName": "vOdsCountHist",
      "ITxtVar": "null",
      "ITxtVarIn": "9872060",
      "SnpTxtHeader": [
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpTxtHeader",
          "ITxt": "9872060",
          "Txt": "SELECT COUNT(1)\nFROM #vSrcNombreTablaOds\nWHERE #vSrcFecha"
        }
      ]
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpVar",
      "DefV": "null",
      "LschemaName": "LS_ODS",
      "VarName": "vSrcFecha",
      "ITxtVar": "null",
      "ITxtVarIn": "11795060",
      "SnpTxtHeader": [
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpTxtHeader",
          "ITxt": "11795060",
          "Txt": "SELECT\n  CASE \n    WHEN Campo = 'NADA' THEN\n        ' 1=1'\n    WHEN Campo = 'FechaCarga' THEN\n          Campo ||   '='  || 'TO_CHAR(TO_DATE(' ||  ''''  ||  '#vSrcFechaCarga'   ||  '''' ||  ' ,'  ||  '''' ||   '#vSrcFormatoFecha'  || ''''  || ' ),'  || ''''  ||  'DDMM'  ||  ''''  || ')' \n    ELSE\n           Campo ||   '='  || 'TO_DATE(' ||  ''''  ||  '#vSrcFechaCarga'   ||  '''' ||  ' ,'  ||  '''' ||   '#vSrcFormatoFecha'  || ''''  || ' )' \n   END\nFROM (\nSELECT NVL(MAX(PARTITION_COL), 'NADA') Campo\nFROM BAN_CONFIG_MTTO_TABLAS_ODS O\nWHERE O.TABLE_NAME = '#vSrcNombreTablaOds'\n AND PARTITION_COL IS NOT NULL \n AND PARTITION_COL != 'N/A'\n)"
        }
      ]
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpVar",
      "DefV": "null",
      "LschemaName": "null",
      "VarName": "vSrcMostrarError",
      "ITxtVar": "768060",
      "ITxtVarIn": "769060",
      "SnpTxtHeader": [
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpTxtHeader",
          "ITxt": "769060",
          "Txt": "Select Error from Dual"
        }
      ]
    }
  ],
  "SnpPop": [
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpPop",
      "LschemaName": "LS_ODS",
      "PopName": "IT_CB _CUENTA _COB_CONTA_ ODS_INICIAL",
      "TableName (Target Table)": "CB_CUENTA"
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpPop",
      "LschemaName": "LS_ODS",
      "PopName": "IT_CB _CUENTA _COB_CONTA_ ODS_DIARIA",
      "TableName (Target Table)": "CB_CUENTA"
    }
  ],
  "SnpScenStep": [
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpScenStep",
      "StepName": "vSrcNombreTablaOds",
      "StepType": "VD",
      "Nno": "0",
      "TableName (Target Table)": "null",
      "SnpScenTask": [
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "0",
          "TaskName1": "Variable",
          "ColTxt": "null",
          "DefTxt": "null",
          "TaskName3": "null",
          "OrdTrt": "null",
          "SnpVar": [
            {
              "Object": "com.sunopsis.dwg.dbobj.SnpVar",
              "VarName": "vSrcNombreTablaOds",
              "DefV": "x"
            }
          ]
        }
      ]
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpScenStep",
      "StepName": "OdsSession Proccessval",
      "StepType": "VD",
      "Nno": "1",
      "TableName (Target Table)": "null",
      "SnpScenTask": [
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "1",
          "TaskName1": "Variable",
          "ColTxt": "null",
          "DefTxt": "null",
          "TaskName3": "null",
          "OrdTrt": "null"
        }
      ]
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpScenStep",
      "StepName": "OdsSession Load",
      "StepType": "V",
      "Nno": "2",
      "TableName (Target Table)": "null",
      "SnpScenTask": [
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "2",
          "TaskName1": "Variable",
          "ColTxt": "null",
          "DefTxt": "select \n<?=snpRef.getPrevStepLog(\"SESS_NO\") ?>\nfrom dual",
          "TaskName3": "null",
          "OrdTrt": "null"
        }
      ]
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpScenStep",
      "StepName": "vSrcFechaCarga",
      "StepType": "VD",
      "Nno": "3",
      "TableName (Target Table)": "null",
      "SnpScenTask": [
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "3",
          "TaskName1": "Variable",
          "ColTxt": "null",
          "DefTxt": "null",
          "TaskName3": "null",
          "OrdTrt": "null",
          "SnpVar": [
            {
              "Object": "com.sunopsis.dwg.dbobj.SnpVar",
              "VarName": "vSrcFechaCarga",
              "DefV": "01/01/1801"
            }
          ]
        }
      ]
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpScenStep",
      "StepName": "vSrcPartition",
      "StepType": "V",
      "Nno": "4",
      "TableName (Target Table)": "null",
      "SnpScenTask": [
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "4",
          "TaskName1": "Variable",
          "ColTxt": "null",
          "DefTxt": "SELECT MAX(GET_PARTITION(to_date('{vSrcFechaCarga}','{vSrcFormatoFecha}'),'{vSrcNombreTablaOds}'))\nFROM DUAL",
          "TaskName3": "null",
          "OrdTrt": "null",
          "SnpVar": [
            {
              "Object": "com.sunopsis.dwg.dbobj.SnpVar",
              "VarName": "vSrcPartition",
              "DefV": "NADA"
            }
          ]
        }
      ]
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpScenStep",
      "StepName": "vSrcTipoCarga",
      "StepType": "V",
      "Nno": "5",
      "TableName (Target Table)": "null",
      "SnpScenTask": [
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "5",
          "TaskName1": "Variable",
          "ColTxt": "null",
          "DefTxt": "SELECT bcsd.COO_ATTRIBUTE1\nFROM BAN_CONFIG_ODS bcsd\nWHERE bcsd.COO_SOURCE = '{vSrcNombreTablaOds}'",
          "TaskName3": "null",
          "OrdTrt": "null",
          "SnpVar": [
            {
              "Object": "com.sunopsis.dwg.dbobj.SnpVar",
              "VarName": "vSrcTipoCarga",
              "DefV": "null"
            }
          ]
        }
      ]
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpScenStep",
      "StepName": "Evaluar vSrcTipoCarga",
      "StepType": "VE",
      "Nno": "6",
      "TableName (Target Table)": "null",
      "SnpScenTask": [
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "6",
          "TaskName1": "Variable",
          "ColTxt": "null",
          "DefTxt": "null",
          "TaskName3": "null",
          "OrdTrt": "null"
        }
      ]
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpScenStep",
      "StepName": "IT_CB _CUENTA _COB_CONTA_ ODS_INICIAL",
      "StepType": "F",
      "Nno": "7",
      "TableName (Target Table)": "CB_CUENTA",
      "SnpScenTask": [
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "7",
          "TaskName1": "Carga",
          "ColTxt": "null",
          "DefTxt": "drop table <?=snpRef.getObjectName(\"L\", \"COL_PRF0CB_CUENTA\", \"W\") ?> purge",
          "TaskName3": "Drop work table",
          "OrdTrt": "20"
        },
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "7",
          "TaskName1": "Carga",
          "ColTxt": "null",
          "DefTxt": "create table <?=snpRef.getObjectName(\"L\", \"COL_PRF0CB_CUENTA\", \"W\") ?>\n(\n\tC1_CU_EMPRESA\tNUMBER(3) NULL,\n\tC2_CU_CUENTA\tVARCHAR2(34) NULL,\n\tC3_CU_CUENTA_PADRE\tVARCHAR2(20) NULL,\n\tC4_CU_NOMBRE\tVARCHAR2(80) NULL,\n\tC5_CU_DESCRIPCION\tVARCHAR2(255) NULL,\n\tC6_CU_ESTADO\tVARCHAR2(1) NULL,\n\tC7_CU_FECHA_ESTADO\tDATE NULL,\n\tC8_CU_MONEDA\tNUMBER(3) NULL\n)\nNOLOGGING",
          "TaskName3": "Create work table",
          "OrdTrt": "30"
        },
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "7",
          "TaskName1": "Carga",
          "ColTxt": "select\t\n\tCB_CUENTA.cu_empresa\t   C1_CU_EMPRESA,\n\tLTRIM(RTRIM(CB_CUENTA.cu_cuenta))\t   C2_CU_CUENTA,\n\tLTRIM(RTRIM(CB_CUENTA.cu_cuenta_padre))\t   C3_CU_CUENTA_PADRE,\n\tLTRIM(RTRIM(CB_CUENTA.cu_nombre))\t   C4_CU_NOMBRE,\n\tLTRIM(RTRIM(CB_CUENTA.cu_descripcion))\t   C5_CU_DESCRIPCION,\n\tCB_CUENTA.cu_estado\t   C6_CU_ESTADO,\n\tCB_CUENTA.cu_fecha_estado\t   C7_CU_FECHA_ESTADO,\n\tCB_CUENTA.cu_moneda\t   C8_CU_MONEDA\nfrom\t<?=snpRef.getObjectName(\"L\", \"cb_cuenta\", \"SOURCE_COB_CONTA\", \"GLOBAL\", \"D\")?>   CB_CUENTA\nwhere\t(1=1)\nAnd (CB_CUENTA.cu_empresa=1)",
          "DefTxt": "insert /*+ append */ into <?=snpRef.getObjectName(\"L\", \"COL_PRF0CB_CUENTA\", \"W\") ?>\n(\n\tC1_CU_EMPRESA,\n\tC2_CU_CUENTA,\n\tC3_CU_CUENTA_PADRE,\n\tC4_CU_NOMBRE,\n\tC5_CU_DESCRIPCION,\n\tC6_CU_ESTADO,\n\tC7_CU_FECHA_ESTADO,\n\tC8_CU_MONEDA\n)\nvalues\n(\n\t%s,\n\t%s,\n\t%s,\n\t%s,\n\t%s,\n\t%s,\n\t%s,\n\t%s\n)",
          "TaskName3": "Load data",
          "OrdTrt": "50"
        },
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "7",
          "TaskName1": "Carga",
          "ColTxt": "null",
          "DefTxt": "BEGIN\nDBMS_STATS.GATHER_TABLE_STATS (\n    ownname =>\t'<?=snpRef.getInfo(\"DEST_WORK_SCHEMA\") ?>',\n    tabname =>\t'<?=snpRef.getObjectName(\"L\", \"COL_PRF0CB_CUENTA\", \"W\").replaceAll(odiRef.getInfo( \"DEST_WORK_SCHEMA\" )+\".\",\"\")?>',\n    estimate_percent =>\tDBMS_STATS.AUTO_SAMPLE_SIZE\n);\nEND;",
          "TaskName3": "Analyze work table",
          "OrdTrt": "70"
        },
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "7",
          "TaskName1": "Integraciï¿½n",
          "ColTxt": "null",
          "DefTxt": "truncate table <?=snpRef.getObjectName(\"L\", \"CB_CUENTA\", \"ODS\", \"GLOBAL\", \"D\") ?>",
          "TaskName3": "Truncate target table",
          "OrdTrt": "80"
        },
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "7",
          "TaskName1": "Carga",
          "ColTxt": "null",
          "DefTxt": "drop table <?=snpRef.getObjectName(\"L\", \"COL_PRF0CB_CUENTA\", \"W\") ?> purge",
          "TaskName3": "Drop work table",
          "OrdTrt": "90"
        },
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "7",
          "TaskName1": "Integraciï¿½n",
          "ColTxt": "null",
          "DefTxt": "insert into\t<?=snpRef.getObjectName(\"L\", \"CB_CUENTA\", \"ODS\", \"GLOBAL\", \"D\") ?> \n( \n\tCU_EMPRESA,\n\tCU_CUENTA,\n\tCU_CUENTA_PADRE,\n\tCU_NOMBRE,\n\tCU_DESCRIPCION,\n\tCU_ESTADO,\n\tCU_FECHA_ESTADO,\n\tCU_MONEDA \n\t,FECHACARGA \n) \n\nselect\n    CU_EMPRESA,\n\tCU_CUENTA,\n\tCU_CUENTA_PADRE,\n\tCU_NOMBRE,\n\tCU_DESCRIPCION,\n\tCU_ESTADO,\n\tCU_FECHA_ESTADO,\n\tCU_MONEDA   \n  ,to_char(to_date('{vSrcFechaCarga}','{vSrcFormatoFecha}'),'DDMM')  \nFROM (\t\n\n\nselect \t\n\tC1_CU_EMPRESA CU_EMPRESA,\n\tC2_CU_CUENTA CU_CUENTA,\n\tC3_CU_CUENTA_PADRE CU_CUENTA_PADRE,\n\tC4_CU_NOMBRE CU_NOMBRE,\n\tC5_CU_DESCRIPCION CU_DESCRIPCION,\n\tC6_CU_ESTADO CU_ESTADO,\n\tC7_CU_FECHA_ESTADO CU_FECHA_ESTADO,\n\tC8_CU_MONEDA CU_MONEDA \nfrom\t<?=snpRef.getObjectName(\"L\", \"COL_PRF0CB_CUENTA\", \"ODS\", \"W\")?>\nwhere\t\t(1=1)\t\n\n\n\n\n\n\n)    ODI_GET_FROM",
          "TaskName3": "Insert new rows",
          "OrdTrt": "100"
        },
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "7",
          "TaskName1": "Integraciï¿½n",
          "ColTxt": "null",
          "DefTxt": "/* commit */",
          "TaskName3": "Commit transaction",
          "OrdTrt": "110"
        },
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "7",
          "TaskName1": "Integraciï¿½n",
          "ColTxt": "null",
          "DefTxt": "DECLARE\n\n\nBEGIN\n\n  PR_ACTUALIZA_ESTADISTICAS('<?=snpRef.getInfo(\"DEST_SCHEMA\") ?>',  '<?=snpRef.getObjectName(\"L\", \"CB_CUENTA\", \"ODS\", \"GLOBAL\", \"D\") ?>', null, TO_DATE('{vSrcFechaCarga}', '{vSrcFormatoFecha}'));\n\nEND;",
          "TaskName3": "Execute Stats",
          "OrdTrt": "150"
        },
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "7",
          "TaskName1": "Integraciï¿½n",
          "ColTxt": "null",
          "DefTxt": "<? String vSess = odiRef.getSession(\"SESS_NO\"); ?>\n<$import Java.lang.*;$>",
          "TaskName3": "Declarar variable sesion paralelismo",
          "OrdTrt": "170"
        }
      ]
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpScenStep",
      "StepName": "vSrcCargaStatus",
      "StepType": "VS",
      "Nno": "8",
      "TableName (Target Table)": "null",
      "SnpScenTask": [
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "8",
          "TaskName1": "Variable",
          "ColTxt": "null",
          "DefTxt": "null",
          "TaskName3": "null",
          "OrdTrt": "null",
          "SnpVar": [
            {
              "Object": "com.sunopsis.dwg.dbobj.SnpVar",
              "VarName": "vSrcCargaStatus",
              "DefV": "null"
            }
          ]
        }
      ]
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpScenStep",
      "StepName": "PROC_UPD_STATUS_CARGA_ODS",
      "StepType": "T",
      "Nno": "9",
      "TableName (Target Table)": "null",
      "SnpScenTask": [
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "9",
          "TaskName1": "Procedimiento",
          "ColTxt": "null",
          "DefTxt": "UPDATE BAN_CONFIG_ODS_DATE\nSET cds_status_carga = '{vSrcCargaStatus}', \n       cds_num_rows = NVL({vOdsCountHist}, -1),\n       cds_last_upd_date = sysdate\nWHERE cds_source = '{vSrcNombreTablaOds}'\nand cds_date = TO_DATE( '{vSrcFechaCarga}', '{vSrcFormatoFecha}')",
          "TaskName3": "UPD BAN_CONF_ODS_DATE Status Carga",
          "OrdTrt": "0"
        },
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "9",
          "TaskName1": "Procedimiento",
          "ColTxt": "null",
          "DefTxt": "UPDATE BAN_CONFIG_ODS\n         SET coo_last_date_sucess = TO_DATE('{vSrcFechaCarga}', '{vSrcFormatoFecha}')\n    WHERE coo_source = '{vSrcNombreTablaOds}'\n      AND  '{vSrcCargaStatus}' = 'PROCESADO'",
          "TaskName3": "UPD BAN_CONF_ODS Last Date Sucess",
          "OrdTrt": "10"
        }
      ]
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpScenStep",
      "StepName": "Status=ERROR?",
      "StepType": "VE",
      "Nno": "10",
      "TableName (Target Table)": "null",
      "SnpScenTask": [
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "10",
          "TaskName1": "Variable",
          "ColTxt": "null",
          "DefTxt": "null",
          "TaskName3": "null",
          "OrdTrt": "null"
        }
      ]
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpScenStep",
      "StepName": "Error - PKG_CON_LOAD_CB_CUENTA_COB_CONTA_ODS",
      "StepType": "V",
      "Nno": "11",
      "TableName (Target Table)": "null",
      "SnpScenTask": [
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "11",
          "TaskName1": "Variable",
          "ColTxt": "null",
          "DefTxt": "Select Error from Dual",
          "TaskName3": "null",
          "OrdTrt": "null"
        }
      ]
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpScenStep",
      "StepName": "IT_CB _CUENTA _COB_CONTA_ ODS_DIARIA",
      "StepType": "F",
      "Nno": "12",
      "TableName (Target Table)": "CB_CUENTA",
      "SnpScenTask": [
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "12",
          "TaskName1": "Integraciï¿½n",
          "ColTxt": "null",
          "DefTxt": "<? String vSess = odiRef.getSession(\"SESS_NO\"); ?>\n<$import Java.lang.*;$>",
          "TaskName3": "Declarar variable sesion paralelismo",
          "OrdTrt": "10"
        },
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "12",
          "TaskName1": "Carga",
          "ColTxt": "null",
          "DefTxt": "drop table <?=snpRef.getObjectName(\"L\", \"COL_PRF0CB_CUENTA\", \"W\") ?> purge",
          "TaskName3": "Drop work table",
          "OrdTrt": "20"
        },
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "12",
          "TaskName1": "Carga",
          "ColTxt": "null",
          "DefTxt": "create table <?=snpRef.getObjectName(\"L\", \"COL_PRF0CB_CUENTA\", \"W\") ?>\n(\n\tC1_CU_EMPRESA\tNUMBER(3) NULL,\n\tC2_CU_CUENTA\tVARCHAR2(34) NULL,\n\tC3_CU_CUENTA_PADRE\tVARCHAR2(20) NULL,\n\tC4_CU_NOMBRE\tVARCHAR2(80) NULL,\n\tC5_CU_DESCRIPCION\tVARCHAR2(255) NULL,\n\tC6_CU_ESTADO\tVARCHAR2(1) NULL,\n\tC7_CU_MOVIMIENTO\tVARCHAR2(1) NULL,\n\tC8_CU_CATEGORIA\tVARCHAR2(1) NULL,\n\tC9_CU_FECHA_ESTADO\tDATE NULL,\n\tC10_CU_MONEDA\tNUMBER(3) NULL\n)\nNOLOGGING",
          "TaskName3": "Create work table",
          "OrdTrt": "30"
        },
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "12",
          "TaskName1": "Carga",
          "ColTxt": "select\t\n\tCB_CUENTA.cu_empresa\t   C1_CU_EMPRESA,\n\tLTRIM(RTRIM(CB_CUENTA.cu_cuenta))\t   C2_CU_CUENTA,\n\tLTRIM(RTRIM(CB_CUENTA.cu_cuenta_padre))\t   C3_CU_CUENTA_PADRE,\n\tLTRIM(RTRIM(CB_CUENTA.cu_nombre))\t   C4_CU_NOMBRE,\n\tLTRIM(RTRIM(CB_CUENTA.cu_descripcion))\t   C5_CU_DESCRIPCION,\n\tCB_CUENTA.cu_estado\t   C6_CU_ESTADO,\n\tCB_CUENTA.cu_movimiento\t   C7_CU_MOVIMIENTO,\n\tCB_CUENTA.cu_categoria\t   C8_CU_CATEGORIA,\n\tCB_CUENTA.cu_fecha_estado\t   C9_CU_FECHA_ESTADO,\n\tCB_CUENTA.cu_moneda\t   C10_CU_MONEDA\nfrom\t<?=snpRef.getObjectName(\"L\", \"cb_cuenta\", \"SOURCE_COB_CONTA\", \"GLOBAL\", \"D\")?>   CB_CUENTA\nwhere\t(1=1)\nAnd (CB_CUENTA.cu_empresa=1)",
          "DefTxt": "insert /*+ append */ into <?=snpRef.getObjectName(\"L\", \"COL_PRF0CB_CUENTA\", \"W\") ?>\n(\n\tC1_CU_EMPRESA,\n\tC2_CU_CUENTA,\n\tC3_CU_CUENTA_PADRE,\n\tC4_CU_NOMBRE,\n\tC5_CU_DESCRIPCION,\n\tC6_CU_ESTADO,\n\tC7_CU_MOVIMIENTO,\n\tC8_CU_CATEGORIA,\n\tC9_CU_FECHA_ESTADO,\n\tC10_CU_MONEDA\n)\nvalues\n(\n\t%s,\n\t%s,\n\t%s,\n\t%s,\n\t%s,\n\t%s,\n\t%s,\n\t%s,\n\t%s,\n\t%s\n)",
          "TaskName3": "Load data",
          "OrdTrt": "50"
        },
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "12",
          "TaskName1": "Carga",
          "ColTxt": "null",
          "DefTxt": "BEGIN\nDBMS_STATS.GATHER_TABLE_STATS (\n    ownname =>\t'<?=snpRef.getInfo(\"DEST_WORK_SCHEMA\") ?>',\n    tabname =>\t'<?=snpRef.getObjectName(\"L\", \"COL_PRF0CB_CUENTA\", \"W\").replaceAll(odiRef.getInfo( \"DEST_WORK_SCHEMA\" )+\".\",\"\")?>',\n    estimate_percent =>\tDBMS_STATS.AUTO_SAMPLE_SIZE\n);\nEND;",
          "TaskName3": "Analyze work table",
          "OrdTrt": "70"
        },
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "12",
          "TaskName1": "Carga",
          "ColTxt": "null",
          "DefTxt": "drop table <?=snpRef.getObjectName(\"L\", \"COL_PRF0CB_CUENTA\", \"W\") ?> purge",
          "TaskName3": "Drop work table",
          "OrdTrt": "90"
        },
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "12",
          "TaskName1": "Integraciï¿½n",
          "ColTxt": "null",
          "DefTxt": "alter table <?=snpRef.getObjectName(\"L\", \"CB_CUENTA\", \"ODS\", \"GLOBAL\", \"D\") ?> truncate partition {vSrcPartition} update indexes",
          "TaskName3": "Truncate target table",
          "OrdTrt": "90"
        },
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "12",
          "TaskName1": "Integraciï¿½n",
          "ColTxt": "null",
          "DefTxt": "insert /*+ APPEND */  into\t   <?=snpRef.getObjectName(\"L\", \"CB_CUENTA\", \"ODS\", \"GLOBAL\", \"D\") ?> \n( \n\tCU_EMPRESA,\n\tCU_CUENTA,\n\tCU_CUENTA_PADRE,\n\tCU_NOMBRE,\n\tCU_DESCRIPCION,\n\tCU_ESTADO,\n\tCU_MOVIMIENTO,\n\tCU_CATEGORIA,\n\tCU_FECHA_ESTADO,\n\tCU_MONEDA \n\t,FECHACARGA \n) \n\nselect\n    CU_EMPRESA,\n\tCU_CUENTA,\n\tCU_CUENTA_PADRE,\n\tCU_NOMBRE,\n\tCU_DESCRIPCION,\n\tCU_ESTADO,\n\tCU_MOVIMIENTO,\n\tCU_CATEGORIA,\n\tCU_FECHA_ESTADO,\n\tCU_MONEDA   \n  ,to_char(to_date('{vSrcFechaCarga}','{vSrcFormatoFecha}'),'DDMM')  \nFROM (\t\n\n\nselect \t\n\tC1_CU_EMPRESA CU_EMPRESA,\n\tC2_CU_CUENTA CU_CUENTA,\n\tC3_CU_CUENTA_PADRE CU_CUENTA_PADRE,\n\tC4_CU_NOMBRE CU_NOMBRE,\n\tC5_CU_DESCRIPCION CU_DESCRIPCION,\n\tC6_CU_ESTADO CU_ESTADO,\n\tC7_CU_MOVIMIENTO CU_MOVIMIENTO,\n\tC8_CU_CATEGORIA CU_CATEGORIA,\n\tC9_CU_FECHA_ESTADO CU_FECHA_ESTADO,\n\tC10_CU_MONEDA CU_MONEDA \nfrom\t<?=snpRef.getObjectName(\"L\", \"COL_PRF0CB_CUENTA\", \"ODS\", \"W\")?>\nwhere\t\t(1=1)\t\n\n\n\n\n\n\n)    ODI_GET_FROM",
          "TaskName3": "Insert new rows",
          "OrdTrt": "110"
        },
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "12",
          "TaskName1": "Integraciï¿½n",
          "ColTxt": "null",
          "DefTxt": "/* commit */",
          "TaskName3": "Commit transaction",
          "OrdTrt": "120"
        },
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "12",
          "TaskName1": "Integraciï¿½n",
          "ColTxt": "null",
          "DefTxt": "DECLARE\n\nBEGIN\n PR_ACTUALIZA_ESTADISTICAS('<?=snpRef.getInfo(\"DEST_SCHEMA\") ?>',  '<?=snpRef.getObjectName(\"L\", \"CB_CUENTA\", \"ODS\", \"GLOBAL\", \"D\") ?>', '{vSrcPartition}', TO_DATE('{vSrcFechaCarga}', '{vSrcFormatoFecha}'));\nEND;",
          "TaskName3": "STATS",
          "OrdTrt": "160"
        }
      ]
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpScenStep",
      "StepName": "vSrcFecha",
      "StepType": "V",
      "Nno": "13",
      "TableName (Target Table)": "null",
      "SnpScenTask": [
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "13",
          "TaskName1": "Variable",
          "ColTxt": "null",
          "DefTxt": "SELECT\n  CASE \n    WHEN Campo = 'NADA' THEN\n        ' 1=1'\n    WHEN Campo = 'FechaCarga' THEN\n          Campo ||   '='  || 'TO_CHAR(TO_DATE(' ||  ''''  ||  '{vSrcFechaCarga}'   ||  '''' ||  ' ,'  ||  '''' ||   '{vSrcFormatoFecha}'  || ''''  || ' ),'  || ''''  ||  'DDMM'  ||  ''''  || ')' \n    ELSE\n           Campo ||   '='  || 'TO_DATE(' ||  ''''  ||  '{vSrcFechaCarga}'   ||  '''' ||  ' ,'  ||  '''' ||   '{vSrcFormatoFecha}'  || ''''  || ' )' \n   END\nFROM (\nSELECT NVL(MAX(PARTITION_COL), 'NADA') Campo\nFROM BAN_CONFIG_MTTO_TABLAS_ODS O\nWHERE O.TABLE_NAME = '{vSrcNombreTablaOds}'\n AND PARTITION_COL IS NOT NULL \n AND PARTITION_COL != 'N/A'\n)",
          "TaskName3": "null",
          "OrdTrt": "null",
          "SnpVar": [
            {
              "Object": "com.sunopsis.dwg.dbobj.SnpVar",
              "VarName": "vSrcFecha",
              "DefV": "null"
            }
          ]
        }
      ]
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpScenStep",
      "StepName": "vOdsCountHist",
      "StepType": "V",
      "Nno": "14",
      "TableName (Target Table)": "null",
      "SnpScenTask": [
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "14",
          "TaskName1": "Variable",
          "ColTxt": "null",
          "DefTxt": "SELECT COUNT(1)\nFROM {vSrcNombreTablaOds}\nWHERE {vSrcFecha}",
          "TaskName3": "null",
          "OrdTrt": "null",
          "SnpVar": [
            {
              "Object": "com.sunopsis.dwg.dbobj.SnpVar",
              "VarName": "vOdsCountHist",
              "DefV": "null"
            }
          ]
        }
      ]
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpScenStep",
      "StepName": "CargaStatus = Error",
      "StepType": "VS",
      "Nno": "15",
      "TableName (Target Table)": "null",
      "SnpScenTask": [
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "15",
          "TaskName1": "Variable",
          "ColTxt": "null",
          "DefTxt": "null",
          "TaskName3": "null",
          "OrdTrt": "null"
        }
      ]
    },
    {
      "Object": "com.sunopsis.dwg.dbobj.SnpScenStep",
      "StepName": "PKG_REGISTRAR_LOG_ODS",
      "StepType": "SE",
      "Nno": "16",
      "TableName (Target Table)": "null",
      "SnpScenTask": [
        {
          "Object": "com.sunopsis.dwg.dbobj.SnpScenTask",
          "Nno": "16",
          "TaskName1": "Comando de Oracle Data Integrator",
          "ColTxt": "null",
          "DefTxt": "OdiStartScen \"-SCEN_NAME=PKG_REGISTRAR_LOG_ODS\" \"-SCEN_VERSION=001\" \"-SESSION_NAME=<?=snpRef.getSession(\"SESS_NO\") ?> PKG_REGISTRAR_LOG_ODS\" \"-SIG.vOdsSessionProccessval={vOdsSessionProccessval}\" \"-SIG.vSrcCargaStatus={vSrcCargaStatus}\" \"-SIG.vSrcNombreTablaOds={vSrcNombreTablaOds}\" \"-SIG.vOdsSessionLoad={vOdsSessionLoad}\" \"-SIG.vSrcFechaCarga={vSrcFechaCarga}\"",
          "TaskName3": "null",
          "OrdTrt": "null"
        }
      ]
    }
  ]
}